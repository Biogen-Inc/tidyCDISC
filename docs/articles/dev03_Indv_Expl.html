<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Individual Explorer • tidyCDISC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Individual Explorer">
<meta property="og:description" content="tidyCDISC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyCDISC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tidyCDISC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Blog.html">Blog posts</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">User Guides</li>
    <li>
      <a href="../articles/x00_Data_Upload.html">00 Data Upload</a>
    </li>
    <li>
      <a href="../articles/x01_Table_Generator.html">01 Table Generator</a>
    </li>
    <li>
      <a href="../articles/x02_Pop_Exp.html">02 Population Explorer</a>
    </li>
    <li>
      <a href="../articles/x03_Indv_Expl.html">03 Individual Explorer</a>
    </li>
    <li>
      <a href="../articles/x04_Filtering.html">04 Filtering</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Biogen-Inc/tidyCDISC/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dev03_Indv_Expl_files/header-attrs-2.13/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Individual Explorer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Biogen-Inc/tidyCDISC/blob/master/vignettes/dev03_Indv_Expl.Rmd"><code>vignettes/dev03_Indv_Expl.Rmd</code></a></small>
      <div class="hidden name"><code>dev03_Indv_Expl.Rmd</code></div>

    </div>

    
    
<p>Learn how to contribute useful code to the individual explorer tab,
by topic.</p>
<div id="integrate-new-events-in-individual-explorer" class="section level2">
<h2 class="hasAnchor">
<a href="#integrate-new-events-in-individual-explorer" class="anchor"></a>Integrate New Events in Individual Explorer</h2>
<p>This tutorial will walk you through how to add / display additional
events on the Individual Explorer Tab. Currently, the app supports
events from ADMH, ADAE, ADCM, ADSL, ADLB, and ADLBC. You’ll note that
most are occurrence (OCCD) class data sets which are designed to be
date-oriented with the exception of ADSL, ADLB, &amp; ADLBC. Regardless
of data set class, the events tab’s module extracts important dates that
you (the developer) chooses from any data set for display.</p>
<p>When incorporating a new date / data set into the events module
you’ll not only need to consider additional UI elements, but there are
two R functions to become familiar with which are introduced below.</p>
<div id="ui-considerations" class="section level3">
<h3 class="hasAnchor">
<a href="#ui-considerations" class="anchor"></a>UI considerations</h3>
<p>In <code>mod_indvExp_ui.R</code>, the input called “checkGroup” &amp;
“overlay_events” are introduced to the app’s user interface. The former
is for the <code>Events</code> tab and the latter is for the
<code>Visits</code> tab.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Events Tab</span>
<span class="fu">checkboxGroupInput</span><span class="op">(</span>
  inputId <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">"checkGroup"</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="st">"For additional patient events, load an AE, LB, LBC, CM, or MH"</span>,
  choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span>,
  selected <span class="op">=</span> <span class="cn">NULL</span>,
  inline <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visits Tab</span>
<span class="fu">checkboxGroupInput</span><span class="op">(</span>
  <span class="fu">ns</span><span class="op">(</span><span class="st">"overlay_events"</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="fu">HTML</span><span class="op">(</span><span class="st">"&lt;br/&gt;Overlay Events:"</span><span class="op">)</span>,
  choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Later, these values will get populated with server side logic that
depends on what the ADaMs the user uploads &amp; the USUBJID selected.
That logic can be found in <code>mod_indvExpPat.R</code> and a snapshot
is shown below. To summarize, the code checks if a supported ADaM
exists, and if it does, that ADaM is assigned an domain abbreviation to
be fed to the <code>choices</code> argument for our two inputs:
checkGroup and overlay_events. Notice how overlay_events only receives a
subset of these choices, because Labs and Medical History aren’t
terribly valuable vertical lines to overlay on the <code>Visits</code>
tab.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># update checkboxes on both Events and Visits Tabs</span>
<span class="co"># Initialize</span>
<span class="va">checked1</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">checked2</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">checked3</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">checked4</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">checked5</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">mh_names</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="co"># check for "adsl" (required), "adae", "adcm", and "adlb"</span>
<span class="kw">if</span> <span class="op">(</span><span class="st">"ADSL"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">checked1</span> <span class="op">&lt;-</span> <span class="st">"DS"</span> <span class="op">}</span>
<span class="kw">if</span> <span class="op">(</span><span class="st">"ADAE"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">checked2</span> <span class="op">&lt;-</span> <span class="st">"AE"</span> <span class="op">}</span>
<span class="kw">if</span> <span class="op">(</span><span class="st">"ADCM"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">checked3</span> <span class="op">&lt;-</span> <span class="st">"CM"</span> <span class="op">}</span>
<span class="kw">if</span> <span class="op">(</span><span class="st">"ADLB"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">checked4</span> <span class="op">&lt;-</span> <span class="st">"LB"</span> <span class="op">}</span>
<span class="kw">if</span> <span class="op">(</span><span class="st">"ADMH"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># For ADMH, we want to create separate checkboxes for each type of </span>
  <span class="co"># Medical History Category that exist in the ADMH for the selected patient.</span>
  <span class="va">mh_names</span> <span class="op">&lt;-</span>
    <span class="fu">datafile</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="st">"ADMH"</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">USUBJID</span> <span class="op">==</span> <span class="va">input</span><span class="op">$</span><span class="va">selPatNo</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">distinct</span><span class="op">(</span><span class="va">MHCAT</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">checked5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"MH_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mh_names</span>, <span class="st">" "</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Combine all into a list</span>
<span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">checked1</span>,<span class="va">checked2</span>,<span class="va">checked3</span>,<span class="va">checked4</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">checked5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milestones"</span>,<span class="st">"Adverse Events"</span>,<span class="st">"Concomitant Meds"</span>,<span class="st">"Labs"</span>,<span class="va">mh_names</span><span class="op">)</span> <span class="co"># ac: labels</span>

<span class="co"># build a named list &amp; Remove NULLs from the list</span>
<span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">choices</span>,<span class="va">names</span><span class="op">)</span>
<span class="va">choices</span> <span class="op">&lt;-</span> <span class="va">choices</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">choices</span>,<span class="va">is.na</span><span class="op">)</span><span class="op">]</span>

<span class="co"># update the checkbox group</span>
<span class="fu">updateCheckboxGroupInput</span><span class="op">(</span>
  session <span class="op">=</span> <span class="va">session</span>,
  inputId <span class="op">=</span> <span class="st">"checkGroup"</span>,
  choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">choices</span><span class="op">)</span>,
  selected <span class="op">=</span> <span class="cn">NULL</span>,
  inline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">#######################################</span>
<span class="co"># Version for vlines on Visits Graph</span>
<span class="co">#######################################</span>
<span class="co"># You can only overlay Milestones, Adverse Events, and Con Meds (currently)</span>
<span class="va">choices2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">checked1</span>,<span class="va">checked2</span>,<span class="va">checked3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">names2</span> <span class="op">&lt;-</span> <span class="va">names</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>

<span class="co"># Setting up colors too</span>
<span class="va">vline_eventtype_cols</span> <span class="op">&lt;-</span> <span class="va">my_cols</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co"># my_cols defined in utils_strObjs.R</span>
<span class="va">v_event_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">vline_eventtype_cols</span>,<span class="va">names2</span><span class="op">)</span>
<span class="va">dashes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solid"</span>,<span class="st">"dotted"</span>,<span class="st">"dashed"</span><span class="op">)</span>
<span class="va">v_event_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">dashes</span>,<span class="va">names2</span><span class="op">)</span>

<span class="co"># build a named list &amp; Remove NULLs from the list</span>
<span class="va">choices2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">choices2</span>,<span class="va">names2</span><span class="op">)</span>
<span class="va">choices2</span> <span class="op">&lt;-</span> <span class="va">choices2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">choices2</span>,<span class="va">is.na</span><span class="op">)</span><span class="op">]</span>

<span class="fu">updateCheckboxGroupInput</span><span class="op">(</span>
  session <span class="op">=</span> <span class="va">session</span>,
  inputId <span class="op">=</span> <span class="st">"overlay_events"</span>,
  choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">choices2</span><span class="op">)</span>, <span class="co"># optionally convert list to array</span>
  selected <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p>Notably, to add another date-oriented data frame into the mix, you
(the developer) will need to add an additional <code>checkedx</code>
where <code>x</code> is the next sequential number of “checked” objects.
For example, if your data set is called “ADMD” where “MD” is the
abbreviation for “My Data”, then you’d need to add these chunks of code
into their respective positions above:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">checked6</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="co"># ...</span>

<span class="kw">if</span> <span class="op">(</span><span class="st">"ADMD"</span> <span class="op">%in%</span> <span class="fu">loaded_adams</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">checked6</span> <span class="op">&lt;-</span> <span class="st">"MD"</span> <span class="op">}</span>

<span class="co"># ...</span>
<span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">checked1</span>,<span class="va">checked2</span>,<span class="va">checked3</span>,<span class="va">checked4</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">checked5</span><span class="op">)</span>,<span class="va">checked6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milestones"</span>,<span class="st">"Adverse Events"</span>,<span class="st">"Concomitant Meds"</span>,<span class="st">"Labs"</span>,<span class="va">mh_names</span>, <span class="st">"My Data"</span><span class="op">)</span> <span class="co"># ac: labels</span>

<span class="co"># ...</span>

<span class="va">choices2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">checked1</span>,<span class="va">checked2</span>,<span class="va">checked3</span>,<span class="va">checked6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">names2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">names</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"My Data"</span><span class="op">)</span></code></pre></div>
<p>Note that adjusting the objects <code>choices2</code> &amp;
<code>names2</code> are optional; only adjust if you (the developer) or
subject matter experts (SMEs) deem it’s appropriate to overlay these
types of events on the plot in the <code>Visits</code> tab.</p>
</div>
<div id="standardize-the-format-of-your-event-data" class="section level3">
<h3 class="hasAnchor">
<a href="#standardize-the-format-of-your-event-data" class="anchor"></a>Standardize the format of your Event data</h3>
<p>Now that the groundwork has been established, it’s time to introduce
the function called <code>org_df_events()</code> which has various (well
documented) arguments in the
<code>mod_indvExp_fct_organizeEvent.R</code> file. This function takes a
data set and manipulates it into a standard form. After being
standardized, the app can (and will) combine it with other standardized
event data frames as necessary.</p>
</div>
<div id="what-it-does" class="section level3">
<h3 class="hasAnchor">
<a href="#what-it-does" class="anchor"></a>What It Does</h3>
<p>Essentially, this function uses lots of shiny inputs to execute the
following (among other things):</p>
<ul>
<li>Validate that the date variable(s)-of-interest exist in the data set
provided</li>
<li>Selects the preferred date variable, allowing for back-ups in case
the user uploads a data set where that date variable doesn’t exist</li>
<li>Toggles the data source if advanced pre-filters exist</li>
<li>Filters to a specific USUBJID and non-missing date variable</li>
<li>Evaluates an expression to display a custom event Description based
on other columns in the data set</li>
<li>Produces a tidy tibble, in a standard format</li>
</ul>
<div id="an-example" class="section level4">
<h4 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An Example</h4>
<p>In the example below, an Adverse Events (ADAE) is standardized using
<code>org_df_events()</code>. The arguments that are pre-fixed with mi_
all come from shiny, but below they’ve been populated with examples to
show the typical values they accept. That said, when implementing a new
events data set, you (the developer) will need to concern yourself with
the first 6 arguments, all of which are well documented on the
function’s help page.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="va">ae_dat</span> <span class="op">&lt;-</span> <span class="fu">org_df_events</span><span class="op">(</span>
      df_name <span class="op">=</span> <span class="st">"ADAE"</span>
    , df_domain_abbr <span class="op">=</span> <span class="st">"AE"</span>
    , df_desc <span class="op">=</span> <span class="st">"Adverse Events"</span>
    , df_st_date_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AESTDT"</span>,<span class="st">"ASTDT"</span><span class="op">)</span>
    , event_desc_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AEDECOD"</span>,<span class="st">"AESEV"</span>,<span class="st">"AESER"</span><span class="op">)</span>
    , event_desc <span class="op">=</span> <span class="st">'paste0(AEDECOD, ", AESEV: ", AESEV, ", AESER: ", AESER)'</span>
    , mi_input_checkbox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DS"</span>,<span class="st">"AE"</span><span class="op">)</span>
    , mi_input_apply_filter <span class="op">=</span> <span class="cn">FALSE</span>
    , mi_usubjid <span class="op">=</span> <span class="st">"01-701-1015"</span>
    , mi_loaded_adams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ADSL"</span>,<span class="st">"ADAE"</span><span class="op">)</span>
    , mi_datafile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ADSL <span class="op">=</span> <span class="va">adsl</span>, ADAE <span class="op">=</span> <span class="va">adae</span><span class="op">)</span>
    , mi_filtered_dat <span class="op">=</span> <span class="va">filtered_dat</span>
  <span class="op">)</span></code></pre></div>
<p>What’s absolutely imperative when calling this function is that the
<code>df_domain_abbr</code> matches the values for the named-list of
choices passed to the <code>updateCheckGroupInput()</code> function used
to update <code>input$checkGroup</code> and
<code>input$overlay_events</code> discussed in
<code>UI Considerations</code>.</p>
<p>Running a publicly available ADAE data set (available through <a href="https://github.com/phuse-org/TestDataFactory/tree/master/Updated/TDF_ADaM">PHUSE’s
gitHub</a>) through <code>org_df_events()</code>, the output
<code>ae_dat</code> might look something like the data frame below.</p>
<p><img src="figures/IndvExp/org_df_events_output.PNG" width="90%" height="90%"></p>
<p>It will always contain these variables, but the amount of rows will
certainly vary. In the example output below, we see that the column
“EVENTTYP” was populated with the <code>df_desc</code> argument. Later,
this will be the Event type label in the <code>timevis</code> object
displayed on the <code>Events</code> tab.</p>
<p>The next column is START which used the “ASTDT” column, which makes
it evident that the ADAE data frame we provided in
<code>mi_datafile</code> (the list of data frames uploaded by the user),
didn’t have the preferred “AESTDT”, so the function selected the next
best date choice: “ASTDT”. It’s important that no matter how many
potential dates you provide in the <code>df_st_date_vars</code> vector,
that at least one of them is a required field according to the current
ADaMIG.</p>
<p>Continuing on, the END variable exists only for date-oriented data
sets that would benefit from seeing a visual start and end of an event.
Typically, “events” happen in one day/ instant. However, an exception to
this would be medical history data where events could include medical
conditions that last several days, months, or years. As such, if you
(the developer) wish to implement new event data that requires showing
the start AND the end of an event, follow the precedent the Medical
History code establishes in the next section called
<code>Build Events</code>. At the end of the day, you just want to
ensure the final output mimics the output above, for reasons that will
also become obvious in the next section.</p>
<p>tab_st and tab_en are just character versions of START and END which
play better with DT output tables in the app.</p>
<p>Last, DECODE contains the event description (<code>event_desc</code>)
you want attached to those dates. So, in this instance, the app will
actually display lots of information. Above, the function weaves
together content from 3 different variables using the paste function:
the adverse event itself, it’s severity and seriousness. However, a
single column that summarizes the event would be sufficient. If you (the
developer) want to supply your own static description for an event, you
should include single quotes within your double quotes. For example:
<code>event_desc = "'Headache'"</code>. Doing so, will make all your
adverse events take the string ‘Headache’.</p>
</div>
</div>
<div id="build-events" class="section level3">
<h3 class="hasAnchor">
<a href="#build-events" class="anchor"></a>Build Events</h3>
<p>Now that we’ve organized our data into a standard format, we need to
combine the events the user selects into a singular data frame to be
used in the app. This task is performed in the
<code>mod_indvExp_fct_buildEvents.R</code> file. By browsing this file,
you’ll witness the function just runs <code>org_df_events()</code> on
all the applicable date-oriented data sets currently supported (ADMH,
ADAE, ADCM, ADSL, and ADLB). The only exception to these is the ADSL and
ADMH files, which require custom considerations when building the
standardized data frame shown above. Therefore, if you (the developer)
wish to add another date-oriented data set into the mix, add your new
org_df_events() function. Then, include the name of your data frame
(let’s say it’s called “md_rec”) when creating this list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uni_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ds_rec</span>, <span class="va">ae_rec</span>, <span class="va">cm_rec</span>, <span class="va">lb_rec</span>, <span class="va">mh_rec</span>, <span class="va">md_rec</span><span class="op">)</span></code></pre></div>
<p>That’s all it takes! A few lines later, <code>uni_list</code> is
rbind-ed into a single data frame (hence the need for uniformity) that
<code>build_events()</code> will sort and return in the app. Once that
data is in the app, it will automatically flow through to the
<code>timevis</code> object on the <code>Events</code> tab or the
<code>Visits</code> tab, if you (the developer) allowed it to do so.</p>
</div>
<div id="color-aesthetics" class="section level3">
<h3 class="hasAnchor">
<a href="#color-aesthetics" class="anchor"></a>Color Aesthetics</h3>
<p>The absolutely last steps is going to be just adjust a few colors
schemes on both the <code>timeviz</code> object on the
<code>Events</code> tab and the plot on the <code>Visits</code> tab.
Why? Because consistency between the tabs will help the users quickly
recognize what type of data they’re observing when the color is always
consistent.</p>
<p>First, to update the colors on the <code>timeviz</code> object on the
<code>Events</code> tab, find the file called
<code>utils_strObjs.R</code> in the R directory. It’s there you’ll find
the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_cols</span> <span class="op">&lt;-</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">7</span>,<span class="st">"Pastel2"</span><span class="op">)</span>

<span class="va">css</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"
              .nav li a.disabled {
              background-color: #aaa !important;
              color: #333 !important;
              cursor: not-allowed !important;
              border-color: #aaa !important;
              }
              
              .vis-item.DS { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.CM { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.AE { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.LB { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.MH_MH { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.MH_FDH { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="st">"; }
              .vis-item.MH_DH { background-color: "</span>,<span class="va">my_cols</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="st">"; }
              "</span><span class="op">)</span></code></pre></div>
<p>If you are adding another date-oriented data set, you’ll manually add
a new color by increasing brewer.pal’s first argument by 1 (from 7 to 8
in this case). Then, you’ll add another row at the bottom. Continuing
with our example, an ADMD would add a row that looks like this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="st">".vis-item.MH_DH { background-color: "</span>,my_cols[<span class="dv">8</span>],<span class="st">"; }"</span></span></code></pre></div>
<p>Similarly, for the <code>Visits</code> tab, you’ll need to add the
name of the new event description to an object called
<code>names2</code>, found in
<code>R/mod_indvExpPatVisits_fct_plot.R</code>, assuming this type of
event is appropriate to overlay on such a plot. Here, we’ve actually
taken the same colors as found in the <code>my_cols</code> vector above,
but tinted them slightly darker so that they are more visible on the
default grey ggplot2 background. Use your discretion whether you should
tint or not. When ready, add the hex digit color to the vector below
called vline_eventtype_cols, in the same element position as in
<code>names2</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># mod_indvExpPatVisits_fct_plot</span>
<span class="va">names2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milestones"</span>,<span class="st">"Concomitant Meds"</span>,<span class="st">"Adverse Events"</span><span class="op">)</span>
<span class="va">vline_eventtype_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#80d1ad"</span>, <span class="st">"#f5ae7d"</span>, <span class="st">"#a8bde6"</span><span class="op">)</span> <span class="co"># dark version of my_cols</span></code></pre></div>
<p>Congratulations! After completing the above steps, you should now
have access to the pertinent event/dates information in the app. With
any questions, please feel free to reach out to app authors/ maintainers
listed in the package documentation.</p>
<p><br></p>
<p><br></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aaron Clark, Maya Gans, Robert Krajcik, Marly Gotti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
